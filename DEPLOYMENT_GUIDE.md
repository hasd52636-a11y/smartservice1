# 🚀 SmartService 部署指南

## 📋 **快速部署流程**

### 方式一：零配置部署（推荐）

#### 1. **连接 GitHub 到 Vercel**
1. 访问 [Vercel Dashboard](https://vercel.com/dashboard)
2. 点击 "New Project"
3. 选择你的 GitHub 仓库
4. 点击 "Import"

#### 2. **项目配置**
```
Root Directory: smart008-main -005
Framework Preset: Vite
Build Command: npm run build
Output Directory: dist
Install Command: npm install
```

#### 3. **部署**
- 点击 "Deploy" 按钮
- 等待部署完成（约2-3分钟）
- 获得生产环境URL

#### 4. **用户配置API密钥**
- 用户访问部署的网站
- 在"客服回复设置"中输入智谱AI密钥
- 点击"测试连接"验证
- 开始使用所有功能

### 方式二：环境变量配置（可选）

如果你想提供备用API密钥，可以在Vercel中设置：

#### 🔐 **环境变量设置**
在 Vercel 项目设置 > Environment Variables 中添加：
```bash
ZHIPU_API_KEY=your_backup_api_key_here
NODE_ENV=production
```

**注意：** 环境变量是完全可选的，主要作为备用密钥使用。

## 🔧 **本地开发**

### 1. **克隆项目**
```bash
git clone <your-repo-url>
cd smart008-main\ -005
```

### 2. **安装依赖**
```bash
npm install
```

### 3. **配置环境变量（可选）**
```bash
# 复制环境变量模板
cp .env.example .env.local

# 编辑 .env.local，添加你的API密钥（可选）
VITE_ZHIPU_API_KEY=your_dev_api_key_here
```

### 4. **启动开发服务器**
```bash
npm run dev
```

## 📋 **环境变量说明**

| 变量名 | 必需 | 说明 | 用途 |
|--------|------|------|------|
| `ZHIPU_API_KEY` | ❌ | 智谱AI备用密钥 | 当用户未配置前端密钥时使用 |
| `VITE_ZHIPU_API_KEY` | ❌ | 开发环境密钥 | 本地开发时避免重复输入 |
| `NODE_ENV` | ❌ | 环境标识 | 自动设置为production |

**重要：** 所有环境变量都是可选的！用户可以在网站上直接配置API密钥。

## 🎯 **部署后使用流程**

### 1. **管理员配置**
- 访问部署的网站
- 创建产品项目
- 上传知识库文件（PDF、TXT等）
- 配置AI系统设置

### 2. **API密钥配置**
- 在"客服回复设置"页面输入智谱AI密钥
- 点击"测试连接"验证密钥有效性
- 系统自动保存到浏览器本地存储

### 3. **生成二维码**
- 在"发布部署"页面生成专属二维码
- 下载高清二维码图片
- 打印并贴在产品包装上

### 4. **用户扫码使用**
- 用户扫描二维码进入对话界面
- 与AI客服进行智能对话
- 上传产品图片进行问题分析
- 获得基于知识库的专业解答

## 🔒 **安全架构说明**

### 前端安全
- **API密钥存储**：浏览器localStorage，用户完全控制
- **数据隔离**：每个用户使用独立的API配额
- **无服务器依赖**：不依赖开发者的服务器资源

### 后端代理
- **请求转发**：通过Vercel Serverless Functions代理API请求
- **密钥保护**：API密钥不暴露在前端代码中
- **CORS处理**：自动处理跨域请求问题

### 数据流向
```
用户输入 → 前端加密 → Vercel代理 → 智谱AI → 返回结果 → 用户界面
```

## 🆘 **常见问题解决**

### Q: API连接测试成功，但实际使用时无响应？
**A:** 这个问题已在最新版本中修复！确保使用最新代码：
- 生产环境现在正确传递API密钥到后端
- Vercel代理优先使用用户配置的密钥
- 备用环境变量作为fallback机制

### Q: 需要在Vercel设置环境变量吗？
**A:** 完全不需要！这是本系统的核心优势：
- 用户在网站上直接配置API密钥
- 零配置部署，开箱即用
- 环境变量只是可选的备用方案

### Q: 如何更新API密钥？
**A:** 非常简单：
- 访问网站的"客服回复设置"页面
- 重新输入新的API密钥
- 点击"测试连接"验证
- 自动保存，立即生效

### Q: 支持多个商家使用吗？
**A:** 完全支持！
- 每个商家配置自己的API密钥
- 使用独立的API配额
- 数据完全隔离
- 成本透明可控

### Q: 部署后页面白屏怎么办？
**A:** 检查以下几点：
1. 确保Root Directory设置为 `smart008-main -005`
2. 检查构建日志是否有错误
3. 验证所有依赖是否正确安装
4. 查看浏览器控制台错误信息

## 🔍 **部署验证清单**

### ✅ **基础功能**
- [ ] 网站可以正常访问
- [ ] 可以创建和编辑项目
- [ ] 知识库文件上传功能正常
- [ ] API密钥配置界面可用

### ✅ **AI功能**
- [ ] API连接测试通过
- [ ] 文本对话功能正常
- [ ] 图片分析功能可用
- [ ] 语音功能正常（如果启用）

### ✅ **二维码功能**
- [ ] 二维码可以正常生成
- [ ] 扫码页面可以访问
- [ ] 用户对话界面正常
- [ ] 移动端适配良好

## 📞 **技术支持**

### 自助诊断
1. 访问网站的"系统诊断"页面
2. 查看所有组件的运行状态
3. 检查API连接和配置状态

### 问题排查
如遇到问题，请按顺序检查：
1. **浏览器控制台**：查看JavaScript错误
2. **网络面板**：检查API请求状态
3. **Vercel日志**：查看服务器端错误
4. **API密钥**：验证密钥格式和有效性

### 联系支持
- 📧 技术支持邮箱：support@smartservice.ai
- 📱 微信技术群：SmartService开发者
- 🌐 官方文档：docs.smartservice.ai

---

## 🎉 **部署成功！**

恭喜！你现在拥有了一个完全自主的AI客服系统：
- 🚀 **零配置部署** - 无需复杂设置
- 💰 **成本可控** - 用户承担自己的API费用  
- 🔒 **数据安全** - 完全的数据隔离和隐私保护
- 📱 **移动优化** - 完美的移动端体验
- 🎯 **即插即用** - 扫码即可使用的便捷体验