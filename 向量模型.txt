向量模型
Embedding-3

> ## Documentation Index
> Fetch the complete documentation index at: https://docs.bigmodel.cn/llms.txt
> Use this file to discover all available pages before exploring further.

# Embedding-3

## <div className="flex items-center"> <svg style={{maskImage: "url(/resource/icon/rectangle-list.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} /> 概览 </div>

Embedding-3 是智谱AI 推出的第三代文本向量化模型，在前代基础上全面升级，提供更强的语义理解能力和更灵活的向量维度选择。该模型支持自定义向量维度，在保持高质量语义表示的同时，为不同应用场景提供了更优的性能和成本平衡。

<CardGroup cols={3}>
  <Card title="价格" icon={<svg style={{maskImage: "url(/resource/icon/coins.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"}/>}>
    0.5 元 / 百万 Tokens
  </Card>

  <Card title="输入模态" icon={<svg style={{maskImage: "url(/resource/icon/arrow-down-right.svg)", WebkitMaskImage: "url(/resource/icon/arrow-down-right.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} />}>
    文本
  </Card>

  <Card title="输出模态" icon={<svg style={{maskImage: "url(/resource/icon/arrow-down-left.svg)", WebkitMaskImage: "url(/resource/icon/arrow-down-left.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} />}>
    向量
  </Card>

  <Card title="上下文窗口" icon={<svg style={{maskImage: "url(/resource/icon/arrow-down-arrow-up.svg)", WebkitMaskImage: "url(/resource/icon/arrow-down-arrow-up.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} />}>
    8K
  </Card>

  <Card title="向量维度" icon={<svg style={{maskImage: "url(/resource/icon/maximize.svg)", WebkitMaskImage: "url(/resource/icon/maximize.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} />}>
    256-2048（可自定义）
  </Card>
</CardGroup>

## <div className="flex items-center"> <svg style={{maskImage: "url(/resource/icon/stars.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} /> 推荐场景 </div>

<AccordionGroup>
  <Accordion title="高精度语义搜索" defaultOpen>
    利用更强的语义理解能力，实现更精准的文档检索和问答系统，特别适合专业领域的知识库构建。
  </Accordion>

  <Accordion title="智能推荐引擎" defaultOpen>
    基于用户行为和内容特征的深度理解，提供更个性化和精准的推荐服务，提升用户体验。
  </Accordion>

  <Accordion title="内容理解与分析" defaultOpen>
    深度分析文本内容的主题、情感和意图，用于舆情监控、内容审核和市场分析。
  </Accordion>

  <Accordion title="知识图谱构建" defaultOpen>
    通过语义向量化技术，自动发现实体关系，构建和完善知识图谱，支持复杂的知识推理。
  </Accordion>
</AccordionGroup>

## <div className="flex items-center"> <svg style={{maskImage: "url(/resource/icon/gauge-high.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} /> 使用资源 </div>

[体验中心](https://bigmodel.cn/trialcenter)：快速测试模型在业务场景上的效果<br />
[接口文档](/api-reference/%E6%A8%A1%E5%9E%8B-api/%E6%96%87%E6%9C%AC%E5%B5%8C%E5%85%A5)：API 调用方式

## <div className="flex items-center"> <svg style={{maskImage: "url(/resource/icon/arrow-up.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} /> 详细介绍 </div>

<Steps>
  <Step title="模型升级" titleSize="h3">
    Embedding-3 在架构和训练数据上都进行了重大升级，显著提升了语义理解的准确性和泛化能力。新模型在多个评测基准上都取得了显著的性能提升。

    **核心升级：**

    * **增强语义理解**：更深层的语义捕捉能力，理解复杂的语言表达
    * **多语言优化**：针对中文、英文等多语言场景进行专门优化
    * **领域适应性**：在科技、金融、医疗等专业领域表现更佳
    * **鲁棒性提升**：对噪声文本和非标准表达有更强的容错能力
  </Step>

  <Step title="灵活维度选择" stepNumber={2} titleSize="h3">
    Embedding-3 支持自定义向量维度，用户可以根据具体应用场景选择最适合的维度，在性能和存储成本之间找到最佳平衡。

    **维度选项：**

    * **2048维（默认）**：最高精度，适合对准确性要求极高的场景
    * **1024维**：高精度与效率的平衡，适合大多数应用场景
    * **512维**：中等精度，适合大规模部署的场景
    * **256维**：较高效率，适合实时性要求高的场景

    **技术参数：**

    * 输入字符串数组中，单条请求最多支持 3072 个 Tokens，且数组最大不得超过 64 条
  </Step>
</Steps>

## <div className="flex items-center"> <svg style={{maskImage: "url(/resource/icon/code.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} /> 调用示例 </div>

以下是一个完整的调用示例，帮助您快速上手 Embedding-3 模型。

<Tabs>
  <Tab title="cURL">
    ```bash  theme={null}
    # 使用默认维度
    curl -X POST \
    https://open.bigmodel.cn/api/paas/v4/embeddings \
    -H "Authorization: Bearer your-api-key" \
    -H "Content-Type: application/json" \
    -d '{
        "model": "embedding-3",
        "input": "这是一段需要向量化的文本"
    }'

    # 自定义维度
    curl -X POST \
    https://open.bigmodel.cn/api/paas/v4/embeddings \
    -H "Authorization: Bearer your-api-key" \
    -H "Content-Type: application/json" \
    -d '{
        "model": "embedding-3",
        "input": "这是一段需要向量化的文本",
        "dimensions": 512
    }'
    ```
  </Tab>

  <Tab title="python">
    **安装 SDK**

    ```bash  theme={null}
    # 安装最新版本
    pip install zai-sdk
    # 或指定版本
    pip install zai-sdk==0.2.0
    ```

    **验证安装**

    ```python  theme={null}
    import zai
    print(zai.__version__)
    ```

    **调用示例**

    ```python  theme={null}
    from zai import ZhipuAiClient

    client = ZhipuAiClient(api_key="your api key")
    response = client.embeddings.create(
        model="embedding-3", #填写需要调用的模型编码
        input=[
            "美食非常美味，服务员也很友好。",
            "这部电影既刺激又令人兴奋。",
            "阅读书籍是扩展知识的好方法。"
        ],
    )
    print(response)
    ```
  </Tab>

  <Tab title="Java">
    **安装 SDK**

    **Maven**

    ```xml  theme={null}
    <dependency>
        <groupId>ai.z.openapi</groupId>
        <artifactId>zai-sdk</artifactId>
        <version>0.3.0</version>
    </dependency>
    ```

    **Gradle (Groovy)**

    ```groovy  theme={null}
    implementation 'ai.z.openapi:zai-sdk:0.3.0'
    ```

    **调用示例**

    ```java  theme={null}
    import ai.z.openapi.ZhipuAiClient;
    import ai.z.openapi.service.embedding.EmbeddingCreateParams;
    import ai.z.openapi.service.embedding.EmbeddingResponse;
    import java.util.Arrays;
    import java.util.List;

    public class Embedding3Example {
        public static void main(String[] args) {
            // 初始化客户端
            ZhipuAiClient client = ZhipuAiClient.builder().ofZHIPU()
                .apiKey("your-api-key")
                .build();

            // 创建向量化请求（自定义维度）
            EmbeddingCreateParams request = EmbeddingCreateParams.builder()
                .model("embedding-3")
                .input(Arrays.asList("Hello world", "How are you?", "How is the weather today?"))
                .dimensions(768)  // 指定768维
                .build();

            // 发送请求
            EmbeddingResponse response = client.embeddings().createEmbeddings(request);
            System.out.println("向量: " + response.getData());
        }
    }
    ```
  </Tab>

  <Tab title="Python(旧)">
    ```python  theme={null}
    from zhipuai import ZhipuAI

    client = ZhipuAI(api_key="your api key")
    response = client.embeddings.create(
        model="embedding-3", #填写需要调用的模型编码
        input=[
            "美食非常美味，服务员也很友好。",
            "这部电影既刺激又令人兴奋。",
            "阅读书籍是扩展知识的好方法。"
        ],
    )
    print(response)
    ```
  </Tab>

  <Tab title="响应示例">
    ```json  theme={null}
    {
        "model": "embedding-3",
        "data": [
    {
        "embedding": [
        -0.02675454691052437,
        0.019060475751757622,
        ......
        -0.005519774276763201,
        0.014949671924114227
        ],
        "index": 0,
        "object": "embedding"
    },
        ...
    {
        "embedding": [
        -0.02675454691052437,
        0.019060475751757622,
        ......
        -0.005519774276763201,
        0.014949671924114227
        ],
        "index": 2,
        "object": "embedding"
    }
        ],
        "object": "list",
        "usage": {
        "completion_tokens": 0,
        "prompt_tokens": 100,
        "total_tokens": 100
    }
    }
    ```
  </Tab>
</Tabs>

## <div className="flex items-center"> <svg style={{maskImage: "url(/resource/icon/feather.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} /> 最佳实践 </div>

<AccordionGroup>
  <Accordion title="维度选择策略">
    根据应用场景选择合适的向量维度：

    * **高精度场景**（如法律文档检索）：使用2048维
    * **通用应用**（如商品推荐）：使用1024或512维
    * **实时应用**（如在线搜索）：使用256维
  </Accordion>

  <Accordion title="性能优化">
    提升向量化性能的建议：

    * 合理使用批处理，单次最多64条文本
    * 预处理文本以去除无关信息
    * 缓存常用文本的向量结果
    * 根据业务需求选择合适的向量维度
  </Accordion>

  <Accordion title="质量提升">
    提高向量质量的技巧：

    * 保持输入文本的完整性和上下文
    * 避免过度分割长文本
    * 统一文本格式和编码
    * 定期评估向量质量并调整策略
  </Accordion>

  <Accordion title="存储优化">
    向量存储的优化建议：

    * 使用适当的向量数据库
    * 建立合适的索引以加速检索
    * 定期清理过期或低质量的向量
    * 考虑向量压缩技术以节省存储空间
  </Accordion>
</AccordionGroup>

## <div className="flex items-center"> <svg style={{maskImage: "url(/resource/icon/square-user.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} /> 用户并发权益 </div>

API 调用会受到速率限制，当前我们限制的维度是请求并发数量（在途请求任务数量）。不同等级的用户并发保障如下。

| V0 | V1  | V2  | V3  |
| :- | :-- | :-- | :-- |
| 50 | 100 | 300 | 500 |


# 安装最新版本
pip install zai-sdk
# 或指定版本
pip install zai-sdk==0.2.0


验证安装
import zai
print(zai.__version__)


调用示例
from zai import ZhipuAiClient

client = ZhipuAiClient(api_key="your api key")
response = client.embeddings.create(
    model="embedding-3", #填写需要调用的模型编码
    input=[
        "美食非常美味，服务员也很友好。",
        "这部电影既刺激又令人兴奋。",
        "阅读书籍是扩展知识的好方法。"
    ],
)
print(response)


**************
向量模型
Embedding-2

> ## Documentation Index
> Fetch the complete documentation index at: https://docs.bigmodel.cn/llms.txt
> Use this file to discover all available pages before exploring further.

# Embedding-2

## <div className="flex items-center"> <svg style={{maskImage: "url(/resource/icon/rectangle-list.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} /> 概览 </div>

Embedding-2 是智谱AI 推出的第二代文本向量化模型，能够将文本转换为高维向量表示，用于语义相似性计算和搜索。该模型在语义理解、文本检索和相似度计算方面表现优异，适用于构建智能搜索、推荐系统和知识库等应用。

<CardGroup cols={3}>
  <Card title="价格" icon={<svg style={{maskImage: "url(/resource/icon/coins.svg)", WebkitMaskImage: "url(/resource/icon/coins.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} />}>
    0.5 元 / 百万 Tokens
  </Card>

  <Card title="输入模态" icon={<svg style={{maskImage: "url(/resource/icon/arrow-down-right.svg)", WebkitMaskImage: "url(/resource/icon/arrow-down-right.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} />}>
    文本
  </Card>

  <Card title="输出模态" icon={<svg style={{maskImage: "url(/resource/icon/arrow-down-left.svg)", WebkitMaskImage: "url(/resource/icon/arrow-down-left.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} />}>
    向量
  </Card>

  <Card title="上下文窗口" icon={<svg style={{maskImage: "url(/resource/icon/arrow-down-arrow-up.svg)", WebkitMaskImage: "url(/resource/icon/arrow-down-arrow-up.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} />}>
    8K
  </Card>

  <Card title="向量维度" icon={<svg style={{maskImage: "url(/resource/icon/maximize.svg)", WebkitMaskImage: "url(/resource/icon/maximize.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} />}>
    1024
  </Card>
</CardGroup>

## <div className="flex items-center"> <svg style={{maskImage: "url(/resource/icon/stars.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} /> 推荐场景 </div>

<AccordionGroup>
  <Accordion title="语义搜索" defaultOpen>
    将用户查询和文档库转换为向量，通过计算向量相似度实现精准的语义搜索，能够理解查询意图而非仅仅匹配关键词。
  </Accordion>

  <Accordion title="文本聚类" defaultOpen>
    将相似主题的文本聚集在一起，用于内容分类、主题发现和文档整理，帮助用户快速理解大量文本的主要内容。
  </Accordion>

  <Accordion title="推荐系统" defaultOpen>
    基于用户历史行为和内容向量化，计算用户偏好与内容的相似度，实现个性化内容推荐。
  </Accordion>

  <Accordion title="异常检测" defaultOpen>
    通过计算文本向量与正常样本的距离，识别异常或可疑内容，用于内容审核和风险控制。
  </Accordion>

  <Accordion title="知识库问答" defaultOpen>
    将知识库文档向量化，通过语义匹配找到与用户问题最相关的文档片段，提供准确的答案。
  </Accordion>
</AccordionGroup>

## <div className="flex items-center"> <svg style={{maskImage: "url(/resource/icon/gauge-high.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} /> 使用资源 </div>

[体验中心](https://bigmodel.cn/trialcenter)：快速测试模型在业务场景上的效果<br />
[接口文档](/api-reference/%E6%A8%A1%E5%9E%8B-api/%E6%96%87%E6%9C%AC%E5%B5%8C%E5%85%A5)：API 调用方式

## <div className="flex items-center"> <svg style={{maskImage: "url(/resource/icon/arrow-up.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} /> 详细介绍 </div>

<Steps>
  <Step title="模型特性" titleSize="h3">
    Embedding-2 采用先进的神经网络架构，能够深度理解文本的语义信息。模型支持中英文等多种语言，在保持高质量向量表示的同时，具有良好的计算效率。

    **核心特性：**

    * **多语言支持**：支持中文、英文等多种语言的文本向量化
    * **语义理解**：能够捕捉文本的深层语义信息，而非仅仅是词汇匹配
    * **高效计算**：优化的模型架构确保快速的向量生成速度
    * **稳定输出**：相同输入始终产生一致的向量表示
  </Step>

  <Step title="技术规格" stepNumber={2} titleSize="h3">
    Embedding-2 提供 1024 维的向量输出，支持最大 8K tokens 的文本输入。模型经过大规模多语言语料训练，在各种文本类型上都有良好的表现。

    **技术参数：**

    * 向量维度：1024 维
    * 输入字符串数组中，单条请求最多支持 512 个 Tokens，数组总长度不得超过 8K
  </Step>
</Steps>

## <div className="flex items-center"> <svg style={{maskImage: "url(/resource/icon/code.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} /> 调用示例 </div>

以下是一个完整的调用示例，帮助您快速上手 Embedding-2 模型。

<Tabs>
  <Tab title="cURL">
    ```bash  theme={null}
    curl -X POST \
    https://open.bigmodel.cn/api/paas/v4/embeddings \
    -H "Authorization: Bearer your-api-key" \
    -H "Content-Type: application/json" \
    -d '{
        "model": "embedding-2",
        "input": "这是一段需要向量化的文本"
    }'
    ```
  </Tab>

  <Tab title="python">
    **安装 SDK**

    ```bash  theme={null}
    # 安装最新版本
    pip install zai-sdk
    # 或指定版本
    pip install zai-sdk==0.2.0
    ```

    **验证安装**

    ```python  theme={null}
    import zai
    print(zai.__version__)
    ```

    **调用示例**

    ```python  theme={null}
    from zai import ZhipuAiClient

    client = ZhipuAiClient(api_key="your api key")
    response = client.embeddings.create(
        model="embedding-2", #填写需要调用的模型编码
        input=[
            "美食非常美味，服务员也很友好。",
            "这部电影既刺激又令人兴奋。",
            "阅读书籍是扩展知识的好方法。"
        ],
    )
    print(response)
    ```
  </Tab>

  <Tab title="Java">
    **安装 SDK**

    **Maven**

    ```xml  theme={null}
    <dependency>
        <groupId>ai.z.openapi</groupId>
        <artifactId>zai-sdk</artifactId>
        <version>0.3.0</version>
    </dependency>
    ```

    **Gradle (Groovy)**

    ```groovy  theme={null}
    implementation 'ai.z.openapi:zai-sdk:0.3.0'
    ```

    **调用示例**

    ```java  theme={null}
    import ai.z.openapi.ZhipuAiClient;
    import ai.z.openapi.service.embedding.EmbeddingCreateParams;
    import ai.z.openapi.service.embedding.EmbeddingResponse;
    import java.util.Arrays;
    import java.util.List;

    public class EmbeddingExample {
        public static void main(String[] args) {
            // 初始化客户端
            ZhipuAiClient client = ZhipuAiClient.builder().ofZHIPU()
                .apiKey("your-api-key")
                .build();

            // 创建向量化请求
            EmbeddingCreateParams request = EmbeddingCreateParams.builder()
                .model("embedding-2")
                .input(Arrays.asList("Hello world", "How are you?", "How is the weather today?"))
                .build();

            // 发送请求
            EmbeddingResponse response = client.embeddings().createEmbeddings(request);
            System.out.println("向量: " + response.getData());
        }
    }
    ```
  </Tab>

  <Tab title="Python(旧)">
    ```python  theme={null}
    from zhipuai import ZhipuAI

    client = ZhipuAI(api_key="your api key")
    response = client.embeddings.create(
        model="embedding-2", #填写需要调用的模型编码
        input=[
            "美食非常美味，服务员也很友好。",
            "这部电影既刺激又令人兴奋。",
            "阅读书籍是扩展知识的好方法。"
        ],
    )
    print(response)
    ```
  </Tab>

  <Tab title="响应示例">
    ```json  theme={null}
    {
        "model": "embedding-3",
        "data": [
    {
        "embedding": [
        -0.02675454691052437,
        0.019060475751757622,
        ......
        -0.005519774276763201,
        0.014949671924114227
        ],
        "index": 0,
        "object": "embedding"
    },
        ...
    {
        "embedding": [
        -0.02675454691052437,
        0.019060475751757622,
        ......
        -0.005519774276763201,
        0.014949671924114227
        ],
        "index": 2,
        "object": "embedding"
    }
        ],
        "object": "list",
        "usage": {
        "completion_tokens": 0,
        "prompt_tokens": 100,
        "total_tokens": 100
    }
    }
    ```
  </Tab>
</Tabs>

## <div className="flex items-center"> <svg style={{maskImage: "url(/resource/icon/feather.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} /> 最佳实践 </div>

<AccordionGroup>
  <Accordion title="文本预处理">
    在向量化之前，建议对文本进行适当的预处理：

    * 去除多余的空格和特殊字符
    * 统一文本格式（如大小写）
    * 对于长文本，考虑分段处理以获得更好的语义表示
  </Accordion>

  <Accordion title="相似度计算">
    使用余弦相似度计算向量间的相似性：

    ```python  theme={null}
    import numpy as np

    def cosine_similarity(vec1, vec2):
        return np.dot(vec1, vec2) / (np.linalg.norm(vec1) * np.linalg.norm(vec2))
    ```
  </Accordion>

  <Accordion title="批量处理">
    为提高效率，建议批量处理多个文本：

    * 单次最多处理 8K 长度文本
    * 合理安排批次大小以平衡速度和资源使用
  </Accordion>
</AccordionGroup>

## <div className="flex items-center"> <svg style={{maskImage: "url(/resource/icon/square-user.svg)", maskRepeat: "no-repeat", maskPosition: "center center",}} className={"h-6 w-6 bg-primary dark:bg-primary-light !m-0 shrink-0"} /> 用户并发权益 </div>

API调用会受到速率限制，当前我们限制的维度是请求并发数量（在途请求任务数量）。不同等级的用户并发保障如下。

| V0 | V1  | V2  | V3  |
| :- | :-- | :-- | :-- |
| 50 | 100 | 300 | 500 |



**********

模型工具
OCR 服务

> ## Documentation Index
> Fetch the complete documentation index at: https://docs.bigmodel.cn/llms.txt
> Use this file to discover all available pages before exploring further.

# OCR 服务

## 产品简介

<Tip>
  本文档旨在帮助开发者、高级用户及系统集成方快速了解并高效使用 OCR 文件解析工具，实现对图片中文字内容的自动识别与结构化输出。
</Tip>

## 产品简介

OCR 文件解析工具支持对各类图像中的文本内容进行识别。可处理印刷体、手写体，并支持中、英、日、韩、法等 20+ 种语言类型。工具能够输出高精度文本识别结果及候选字置信度信息，适用于手写稿件解析、文档数字化、图片文字抽取等多种业务场景。

## 使用说明

* 需要低延迟、即时拿到解析结果的在线处理链路（如用户上传后立刻问答、预览）。
* 单次文件不大、结构复杂度适中，或对纯文本抽取需求为主。

**支持的文件格式与大小**

|   服务项目  | 说明               |
| :-----: | :--------------- |
| 支持的文件类型 | image（图片文件）      |
|  支持的格式  | PNG、JPG、JPEG、BMP |
|  最大文件大小 | **8M**           |

**请求参数说明**

| 参数名称           | 字段类型    | 是否必填 | 说明                                                                                                                                                                   |
| :------------- | :------ | :--- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| file           | File    | 是    | 图片文件（支持 PNG/JPG/JPEG/BMP），8M 内                                                                                                                                       |
| tool\_type     | String  | 是    | 固定为 `hand_write`，表示执行手写体识别                                                                                                                                           |
| language\_type | String  | 否    | 根据所识别文件可指定识别语言，默认为 `CHN_ENG`，自动检测语言：`AUTO`，可选值包括：`ENG, JAP, KOR, FRE, SPA, POR, GER, ITA, RUS, DAN, DUT, MAL, SWE, IND, POL, ROM, TUR, GRE, HUN, THA, VIE, ARA, HIN` |
| probability    | Boolean | 否    | 是否返回识别结果中每一行的置信度，默认为false，不返回置信度                                                                                                                                     |

**输出参数说明**

| 参数名称               | 字段类型    | 说明                                                                                                                                   |
| :----------------- | :------ | :----------------------------------------------------------------------------------------------------------------------------------- |
| task\_id           | String  | 任务 ID                                                                                                                                |
| message            | String  | 提示信息，例如成功或错误描述                                                                                                                       |
| status             | String  | 状态标识                                                                                                                                 |
| words\_result\_num | Integer | 识别结果数，表示words\_result的元素个数                                                                                                           |
| words\_result      | object  | 文本识别结果对象                                                                                                                             |
| ├── location       | object  | 每行的坐标，包含：<br /> - left： 表示定位位置的长方形左上顶点的水平坐标<br /> - top：表示定位位置的长方形左上顶点的垂直坐标<br /> - width：表示定位位置的长方形的宽度<br /> - height：表示定位位置的长方形的高度 |
| ├── words          | String  | 每一行的识别结果                                                                                                                             |
| └── probability    | object  | 当 probability=true 时返回该字段，表示识别结果中每一行的置信度值，包含：<br /> - average： 行置信度平均值<br /> - variance：行置信度方差<br /> - min：行置信度最小值                   |

## 计费方式

<table>
  <tr>
    <td><strong>计费规则</strong></td>
    <td>OCR 解析工具根据识别过程中调用量中的页数收取费用，当前支持单次单页识别。</td>
  </tr>

  <tr>
    <td><strong>单价</strong></td>
    <td>0.01 元 / 次(页)</td>
  </tr>

  <tr>
    <td><strong>计费计算方式</strong></td>
    <td>请求次数(页数) × 单价 = 费用</td>
  </tr>
</table>

## 使用流程说明

1. 准备图片文件（确保格式与大小符合要求）
2. 根据需要设置可选识别参数（如 tool\_type、language\_type、probability），当已知文件语言时，建议设置对应的 language\_type 以提高识别准确率
3. 调用 OCR 解析接口
4. 获取返回的 JSON 结果
5. 从 words\_result 中读取识别内容
6. 根据需要展示、存储或进一步处理文本

## 最佳实践与建议

* 上传图像尽量保持 清晰、无遮挡、无遮挡反光，提升识别准确率。
* 手写体建议使用 黑色或深色墨迹，背景尽量为浅色。
* 建议对返回结果中的置信度进行业务层过滤，以提升整体系统可信度。

## 调用示例

<Tabs>
  <Tab title="cURL">
    ```bash  theme={null}
    curl --location --request POST 'https://open.bigmodel.cn/api/paas/v4/files/ocr' \
    --header  'Authorization: Bearer your_api_token' \
    --form 'file=@example-file' \
    --form 'tool_type="hand_write"' \
    --form 'language_type="CHN_ENG"' \
    --form 'probability="true"'
    ```
  </Tab>

  <Tab title="Python">
    ```bash  theme={null}
    # 安装最新版本
    pip install zai-sdk

    # 或指定版本
    pip install zai-sdk==0.2.0
    ```

    ```python  theme={null}
    from zai import ZhipuAiClient

    client = ZhipuAiClient(api_key="your api key")

    def handwriting_ocr_example():
        """
        完整示例：提交图片进行识别并等待结果返回。
        """
        # 请修改为本地图片路径
        file_path = 'Your image path'
        with open(file_path, 'rb') as f:
            print("正在提交手写识别任务 ...")
            response = client.ocr.handwriting_ocr(
                file=f,
                tool_type="hand_write",
                probability=True
            )
            print("任务创建成功，返回结果如下：")
            print(response)

        print("手写识别示例结束。")


    if __name__ == "__main__":
        print("=== 手写识别快速演示 ===\n")
        handwriting_ocr_example()
    ```
  </Tab>

  <Tab title="Java">
    **安装 SDK**

    **Maven**

    ```xml  theme={null}
    <dependency>
        <groupId>ai.z.openapi</groupId>
        <artifactId>zai-sdk</artifactId>
        <version>0.3.0</version>
    </dependency>
    ```

    ```java  theme={null}
    public class HandwritingOcrExample {

    public static void main(String[] args) {
      ZhipuAiClient client = ZhipuAiClient.builder().ofZHIPU()
              .apiKey("your-real-api-key")
              .build();

      try {
          System.out.println("=== 手写识别示例 ===");

          String filePath = ""; // 请修改为你自己的图片路径
          HandwritingOcrResponse response = syncHandwritingOcrExample(client, filePath, "hand_write", "CHN_ENG", true);
          if (response != null && response.getData() != null) {
              System.out.println(response.getData());
          } else {
              System.out.println("识别失败。");
          }
      } catch (Exception e) {
          System.err.println("出现异常: " + e.getMessage());
          e.printStackTrace();
      }
    }

    /**
    * 示例：上传图片并进行手写 OCR 识别
    * @param client ZhipuAiClient 实例
    * @param filePath 图片文件路径
    * @param toolType 识别工具类型
    * @param languageType 语言类型（可选）
    * @return OCR响应对象
    */
    private static HandwritingOcrResponse syncHandwritingOcrExample(ZhipuAiClient client, String filePath, String toolType,
                                                                  String languageType, Boolean probability) {
      if (filePath == null || filePath.trim().isEmpty()) {
          System.err.println("文件路径无效。");
          return null;
      }
      try {
          HandwritingOcrUploadReq uploadReq = new HandwritingOcrUploadReq();
          uploadReq.setFilePath(filePath);
          uploadReq.setToolType(toolType); // 必须为 "hand_write"
          uploadReq.setLanguageType(languageType); // 可以为 "CHN_ENG"、"ENG" 等
          uploadReq.setProbability(probability);
          System.out.println(uploadReq.toString());
          System.out.println("正在上传图片并进行手写识别...调用 API 中");
          return client.handwriting().recognize(uploadReq);
      }
      catch (Exception e) {
          System.err.println("手写识别任务出错: " + e.getMessage());
      }
      // 返回 null 表示失败
      return null;
    }
    }
    ```
  </Tab>

  <Tab title="响应示例">
    ```
    // 成功响应示例
    {
        "task_id": "658c5c5e9d4f4f8c8c8c8c8c",
        "message": "success",
        "status": "succeeded",
        "words_result_num": 11,
        "words_result": [
            {
                "location": {
                    "left": 125,
                    "top": 76,
                    "width": 756,
                    "height": 127
                },
                "words": "book ruler pencil schoolbag"
            },
            ...
        ]
    }
    // 失败响应示例
    {
        "task_id": null,
        "message": "上传的图片格式错误（仅支持PNG、JPG、JPEG、BMP）",
        "status": null,
        "words_result_num": 0
    }
    ```
  </Tab>
</Tabs>
